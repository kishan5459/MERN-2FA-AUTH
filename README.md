
---

# ðŸŒŸ MERN Authentication System with 2FA, Google Login & Stripe Payments

Check out the live frontend: [https://mern-2fa-auth-client.onrender.com/](https://mern-2fa-auth-client.onrender.com/)

---

## **Backend (Express + MongoDB + Passport + Stripe)**

### **Authentication & Session Management**

* `/register` â€“ User registration with password hashing (`bcryptjs`).
* `/login` â€“ Login with **passport-local strategy**, IP logging middleware, and session handling (`express-session` + `connect-mongo`).
* `/logout` â€“ Secure session termination.
* `/status` â€“ Check current authentication state.

### **Two-Factor Authentication (2FA)**

* `/2fa/setup` â€“ Generate QR code (using `qrcode`) for Google Authenticator setup.
* `/2fa/verify` â€“ Verify **TOTP codes** generated by Google Authenticator (`speakeasy`).
* `/2fa/reset` â€“ Reset 2FA configuration for users.

### **Google OAuth 2.0 Authentication**

* `/google` â€“ Redirects to Google login (via `passport-google-oauth20`).
* `/google/callback` â€“ Handles OAuth callback and redirects to frontend (`/google-success?login=true`).

### **Stripe Payments Integration**

* **Checkout Sessions** â€“ Users can subscribe to **Basic Plan**, **Annual Plan**, or one-time **Newsletter Purchase** (`/stripe/checkout/...`).
* **Shipping Options** â€“ Free or standard shipping selection for physical products.
* **Automatic Tax Calculation** â€“ Taxes applied automatically via Stripe settings.
* **Coupons & Discounts** â€“ Promo codes supported to apply discounts.
* **Multi-Currency Support** â€“ Payments accepted in **USD** and **INR**.
* **Invoices** â€“ Auto-generated Stripe invoices (PDF + hosted invoice URL).
* **Webhook Event Handling** â€“ Sync your backend with Stripe payment events:

  * `checkout.session.completed` â†’ Marks one-time checkout as complete
  * `invoice.payment_succeeded` â†’ Confirms subscription payments and renewals
  * `invoice.payment_failed` â†’ Marks subscription as past_due
  * `customer.subscription.deleted` â†’ Cancels or terminates subscription
  * `charge.succeeded` & `charge.updated` â†’ Updates payment records and receipts

### **User Payment Management**

* `/my-sessions` â†’ List active Stripe checkout sessions.
* `/my-sessions/:sessionId` â†’ Delete a specific session.
* `/my-payments` â†’ Fetch userâ€™s payments & subscription records.
* `/my-payments/:subscriptionId` â†’ Cancel a subscription.
* `/me` â†’ Fetch current authenticated user info.

---

## **Frontend (React + React Router + Tailwind CSS)**

### **User Flow Pages**

* `/login` â€“ Login form with **Google Sign-In** option.
* `/google-success` â€“ Handles successful Google OAuth login.
* `/setup-2fa` â€“ User scans QR code to enable 2FA.
* `/verify-2fa` â€“ Enter OTP from Google Authenticator to verify.
* `/` â€“ Home page, accessible only after authentication.
* **Payments UI** â€“ Checkout buttons for **Basic Plan**, **Annual Plan**, and **Newsletter** purchases.
* **Invoices & Payment History** â€“ Users can view invoices (Stripe-hosted or PDF).

### **Security & UX Enhancements**

* **Protected Routes** â€“ `ProtectedRoute` component guards private pages.
* **React Context / State** â€“ Global session management and authentication state tracking.
* **Error Handling** â€“ Custom `Error` page for invalid routes or failed authentication.
* **Axios** â€“ API integration with secure cookie-based sessions.
* **Tailwind CSS** â€“ Modern, responsive UI with utility-first design.

---

## **Important Notes**

* Use **Google Authenticator** app to scan the QR code and generate TOTP for 2FA.
* The project uses a **free-tier deployment**, so the server may take a few seconds to wake up after inactivity.

---

## **Tech Stack**

* **Backend:** Node.js, Express, MongoDB, Passport, Stripe, bcryptjs, speakeasy, qrcode, express-session, connect-mongo
* **Frontend:** React, React Router, Tailwind CSS
* **Authentication:** JWT + Session Cookies + Google OAuth
* **Payments & Billing:** Stripe Checkout, Webhooks, Coupons, Shipping, Taxes
* **State Management:** React Context

---
## ðŸŽ¥ Demo Video

[Watch the demo](https://drive.google.com/file/d/1M7X0WHDHZLRDXMfb4cFH4ruDA_2vesY7/view?usp=drive_link)

change quality to 720p and increase speed(if you need) for better experience while playing video
